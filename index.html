<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Racing Game ‚Äî BMC</title>

<style>
:root{
  --bg0:#FFE5F1;
  --bg1:#F3E9FF;
  --txt: rgba(20,20,30,.92);
  --muted: rgba(20,20,30,.62);
  --stroke: rgba(0,0,0,.12);
  --radius: 20px;
  --shadow: 0 16px 48px rgba(0,0,0,.18);
}

/* ===== Base ===== */
*{box-sizing:border-box}
body{
  margin:0;
  font-family: system-ui,-apple-system,Segoe UI,Roboto;
  background:
    radial-gradient(900px 600px at 25% 20%, rgba(255,111,177,.25), transparent 60%),
    radial-gradient(900px 700px at 80% 18%, rgba(139,92,255,.22), transparent 60%),
    linear-gradient(180deg,var(--bg0),var(--bg1));
  color:var(--txt);
}
.wrap{
  max-width:1200px;
  margin:0 auto;
  padding:24px;
}

/* ===== Header ===== */
header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  margin-bottom:16px;
}
h1{margin:0;font-size:38px}
.subtitle{color:var(--muted)}
.tip{
  font-size:13px;
  padding:8px 12px;
  border-radius:999px;
  background:rgba(0,0,0,.08);
}

/* ===== Panels ===== */
.panel{
  background:rgba(255,255,255,.55);
  backdrop-filter: blur(16px);
  border-radius:var(--radius);
  border:1px solid var(--stroke);
  box-shadow:var(--shadow);
}

/* ===== TOP AREA ===== */
.top{
  display:grid;
  grid-template-columns: 1.2fr .8fr;
  gap:14px;
  margin-bottom:14px;
}
@media(max-width:900px){
  .top{grid-template-columns:1fr}
}

/* ===== SETTINGS ===== */
.controls{padding:16px}
.row{margin-bottom:12px}
label{font-size:13px;color:var(--muted)}
.input{
  display:flex;
  gap:10px;
  align-items:center;
  background:rgba(0,0,0,.08);
  padding:10px 12px;
  border-radius:12px;
}
input[type=range],select{
  flex:1;
}
.btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
button{
  padding:10px 14px;
  border-radius:12px;
  border:0;
  cursor:pointer;
  font-weight:600;
}
.primary{background:#6C7CFF;color:white}
.ghost{background:#E6E6F0}
.danger{background:#FFD6DE}

/* ===== RACERS ===== */
.roster{padding:16px;display:flex;flex-direction:column}
.rosterTop{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:8px;
}
.list{
  max-height:260px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:8px;
  padding-right:4px;
}
.racer{
  display:grid;
  grid-template-columns: 44px 1fr 32px;
  gap:8px;
  align-items:center;
  background:rgba(0,0,0,.06);
  padding:8px;
  border-radius:12px;
}
.avatar{
  width:44px;height:32px;
  border-radius:10px;
  background:#ddd;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.avatar img{width:100%;height:100%;object-fit:cover;border-radius:10px}
.racer input{
  border:0;
  background:transparent;
  outline:none;
}
.racer .x{
  background:#F3B6C0;
  border-radius:999px;
  text-align:center;
  cursor:pointer;
}

/* ===== TRACK ===== */
.track{padding:16px}
.trackTop{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:10px;
}
.progress{
  display:flex;
  align-items:center;
  gap:8px;
}
.bar{
  width:200px;height:10px;
  background:rgba(0,0,0,.12);
  border-radius:999px;
  overflow:hidden;
}
.bar i{
  display:block;
  height:100%;
  width:0%;
  background:#6C7CFF;
}
.lanes{
  position:relative;
  background:rgba(0,0,0,.06);
  border-radius:16px;
  overflow:hidden;
}
.lane{
  height:56px;
  border-top:1px dashed rgba(0,0,0,.12);
  position:relative;
}
.kart{
  position:absolute;
  left:8px;
  top:50%;
  transform:translateY(-50%);
  display:flex;
  align-items:center;
  gap:8px;
}
.bubble{
  width:36px;height:36px;
  border-radius:10px;
  background:white;
  display:flex;
  align-items:center;
  justify-content:center;
}
.tag{
  background:rgba(255,255,255,.7);
  padding:6px 10px;
  border-radius:10px;
  font-size:13px;
}

/* ===== Footer ===== */
footer{
  margin-top:12px;
  font-size:13px;
  color:var(--muted);
}
</style>
</head>

<body>
<div class="wrap">
<header>
  <div>
    <h1>Racing Game üë§</h1>
    <div class="subtitle">a product of BMC ‚Äì Marketing Transformation team</div>
  </div>
  <div class="tip">Space: Start/Pause ¬∑ B: Boost</div>
</header>

<!-- TOP -->
<section class="top">
  <!-- SETTINGS -->
  <div class="controls panel">
    <div class="row">
      <label>Race length</label>
      <div class="input">
        üèÅ
        <input id="raceLength" type="range" min="700" max="1600" value="1100"/>
        <span id="raceLengthLabel">1100px</span>
      </div>
    </div>

    <div class="row">
      <label>Theme</label>
      <div class="input">
        üé®
        <select id="theme">
          <option value="fb" selected>F&B Emojis</option>
          <option value="mood">Mood Emojis</option>
          <option value="momo">MoMo Illustration</option>
        </select>
      </div>
    </div>

    <div class="btns">
      <button class="primary" id="startBtn">Start</button>
      <button class="ghost" id="pauseBtn" disabled>Pause</button>
      <button class="ghost" id="resetBtn">Reset</button>
      <button class="danger" id="clearBtn">Clear</button>
    </div>
  </div>

  <!-- RACERS -->
  <div class="roster panel">
    <div class="rosterTop">
      <b>Racers (<span id="count">0</span>)</b>
      <div class="btns" style="margin:0">
        <button class="ghost" id="uploadAll">Upload all list</button>
        <input id="uploadAllInput" type="file" multiple accept="image/*" hidden>
        <button id="addBtn">+ Add</button>
      </div>
    </div>

    <div class="list" id="racerList"></div>

    <footer>
      Upload nhi·ªÅu ·∫£nh 1 l·∫ßn ‚Üí t·ª± t·∫°o ng∆∞·ªùi ch∆°i (t√™n = t√™n file)
    </footer>
  </div>
</section>

<!-- TRACK -->
<section class="track panel">
  <div class="trackTop">
    <div>Status: <b id="status">idle</b> ¬∑ Winner: <b id="winner">‚Äî</b></div>
    <div class="progress">
      <div class="bar"><i id="bar"></i></div>
      <span id="pct">0%</span>
    </div>
  </div>

  <div class="lanes" id="lanes"></div>
</section>
</div>

<script>
/* ========= STATE ========= */
let racers=[],running=false,finished=false,raf=null;
const list=document.getElementById("racerList");
const lanes=document.getElementById("lanes");
const statusEl=document.getElementById("status");
const winnerEl=document.getElementById("winner");
const bar=document.getElementById("bar");
const pct=document.getElementById("pct");
const count=document.getElementById("count");

/* ========= RACERS ========= */
function addRacer(name="",img=null){
  const el=document.createElement("div");
  el.className="racer";
  el.innerHTML=`
    <div class="avatar">${img?`<img src="${img}">`:"üôÇ"}</div>
    <input placeholder="Nh·∫≠p t√™n" value="${name}">
    <div class="x">‚úï</div>
  `;
  list.appendChild(el);

  el.querySelector(".x").onclick=()=>{el.remove();sync()};
  sync();
}
function sync(){
  racers=[...list.children].map((r,i)=>({
    name:r.querySelector("input").value||`Racer ${i+1}`,
    x:0,
    v:Math.random()*120+140,
    el:null
  }));
  count.textContent=racers.length;
  buildTrack();
}

/* ========= TRACK ========= */
function buildTrack(){
  lanes.innerHTML="";
  racers.forEach(r=>{
    const lane=document.createElement("div");
    lane.className="lane";
    const kart=document.createElement("div");
    kart.className="kart";
    kart.innerHTML=`
      <div class="bubble">üèéÔ∏è</div>
      <div class="tag">${r.name}</div>
    `;
    lane.appendChild(kart);
    lanes.appendChild(lane);
    r.el=kart;
  });
}

/* ========= LOOP ========= */
function loop(){
  if(!running) return;
  let lead=0;
  racers.forEach(r=>{
    r.v+= (Math.random()-0.5)*30;
    r.x+=r.v*0.016;
    r.x=Math.max(0,r.x);
    r.el.style.transform=`translate(${r.x}px,-50%)`;
    lead=Math.max(lead,r.x);
  });
  const p=Math.min(100,lead/1000*100);
  bar.style.width=p+"%";
  pct.textContent=Math.floor(p)+"%";
  raf=requestAnimationFrame(loop);
}

/* ========= CONTROLS ========= */
document.getElementById("startBtn").onclick=()=>{
  if(running) return;
  running=true;
  finished=false;
  statusEl.textContent="racing";
  loop();
};
document.getElementById("pauseBtn").onclick=()=>{
  running=!running;
  statusEl.textContent=running?"racing":"paused";
  if(running) loop();
};
document.getElementById("resetBtn").onclick=()=>{
  running=false;
  statusEl.textContent="idle";
  racers.forEach(r=>r.x=0);
  buildTrack();
  bar.style.width="0%";
  pct.textContent="0%";
};
document.getElementById("clearBtn").onclick=()=>{
  list.innerHTML="";
  sync();
};
document.getElementById("addBtn").onclick=()=>addRacer();

/* Upload all */
document.getElementById("uploadAll").onclick=()=>uploadAllInput.click();
uploadAllInput.onchange=async e=>{
  list.innerHTML="";
  for(const f of e.target.files){
    const reader=new FileReader();
    reader.onload=()=>addRacer(f.name.replace(/\..+/,""),reader.result);
    reader.readAsDataURL(f);
  }
};
</script>
</body>
</html>
